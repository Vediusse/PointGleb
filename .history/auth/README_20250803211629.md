# Auth Module

Модуль авторизации для микросервисной архитектуры.

## Описание

Этот модуль предоставляет полную функциональность авторизации на основе JWT токенов. Модуль можно легко подключить к любому сервису для добавления авторизации.

## Компоненты

- **JWT Authentication Filter** - фильтр для проверки JWT токенов
- **JWT Token Provider** - генерация и валидация JWT токенов
- **Security Configuration** - конфигурация Spring Security
- **User Management** - управление пользователями и ролями
- **Password Encoding** - кодирование паролей

## Использование

### 1. Добавьте зависимость в pom.xml

```xml
<dependency>
    <groupId>com.viancis</groupId>
    <artifactId>auth</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</dependency>
```

### 2. Добавьте аннотацию @EnableAuth к главному классу приложения

```java
import com.viancis.auth.annotation.EnableAuth;

@SpringBootApplication
@EnableAuth
public class YourApplication {
    public static void main(String[] args) {
        SpringApplication.run(YourApplication.class, args);
    }
}
```

### 3. Настройте application.properties

```properties
jwt.secret=your-secret-key
jwt.expiration=360000000
```

### 4. Настройте EntityScan и EnableJpaRepositories

```java
@EntityScan(basePackages = {"com.viancis.auth.model"})
@EnableJpaRepositories(basePackages = {"com.viancis.auth.repository"})
```

## Модели данных

### User
- `id` - UUID
- `username` - уникальное имя пользователя
- `password` - закодированный пароль
- `roles` - набор ролей пользователя

### Role
- `USER` - обычный пользователь
- `MODERATOR` - модератор
- `ADMIN` - администратор
- `ANONYM` - анонимный пользователь

## Безопасность

Модуль автоматически:
- Отключает CSRF для API
- Настраивает CORS
- Устанавливает stateless сессии
- Добавляет JWT фильтр
- Настраивает обработку ошибок авторизации

## Исключения

- `CustomAuthenticationException` - ошибка аутентификации
- `InvalidCredentialsException` - неверные учетные данные
- `UserNotFoundException` - пользователь не найден
- `UserAlreadyExistsException` - пользователь уже существует
